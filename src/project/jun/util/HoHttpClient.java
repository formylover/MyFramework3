package project.jun.util;import java.io.IOException;import java.io.InputStream;import java.io.InputStreamReader;import java.io.UnsupportedEncodingException;import java.net.URLEncoder;import java.util.ArrayList;import org.apache.commons.httpclient.HttpClient;import org.apache.commons.httpclient.HttpMethod;import org.apache.commons.httpclient.HttpStatus;import org.apache.commons.httpclient.NameValuePair;import org.apache.commons.httpclient.methods.GetMethod;import org.apache.commons.httpclient.methods.PostMethod;/** * Http client *  */public class HoHttpClient{	private HttpClient client = null;	private String parameterCharSet = null;	private ArrayList parameterList = null;	private int statusCode;	private String statusText;	private String response;		public HoHttpClient( String parameterCharSet )	{		this.parameterCharSet = parameterCharSet;		parameterList = new ArrayList();		client = new HttpClient();	}		/**	 * post(), get(); 	 * @return	 */	public int getStatusCode() {		return statusCode;	}	/**	 * post(), get(); 	 * @return 	 */	public String getStatusText() {		return statusText;	}	/**	 * post(), get(); 	 * 	 * @return body	 */	public String getResponse()	{		return response;	}		/**	 * parameter	 *	 */	public void clearParam()	{		parameterList.clear();	}		/**	 * parameter	 * 	 * @param name parameter name	 * @param value parameter value	 */	public void addParam( String name, String value )	{		NameValuePair param = new NameValuePair(name, value);		parameterList.add( param );	}		/**	 * post(), get(); 	 * 	 * @param method	 * @return	 * @throws IOException	 */	private String getBody( HttpMethod method ) throws IOException	{        InputStream body = method.getResponseBodyAsStream();        InputStreamReader rd = new InputStreamReader(body);		StringBuffer sb = new StringBuffer();		char[] buf = new char[1024];		int readCnt;		while( (readCnt = rd.read(buf)) != -1 )			sb.append(buf, 0, readCnt);		return sb.toString();	}		/**	 * GET METHOD	 * 	 * @param url 	 * @return true: 	 * @throws UnsupportedEncodingException	 */	public boolean get( String url ) throws UnsupportedEncodingException	{		HttpMethod method = new GetMethod( url );				NameValuePair param = null;		StringBuffer bufParam = new StringBuffer();		for( int i = 0; i < parameterList.size(); i++ )		{			param = (NameValuePair)parameterList.get(i);			bufParam.append( param.getName() + "=" + URLEncoder.encode( param.getValue(), parameterCharSet) + "&" );		}		method.setQueryString(bufParam.toString());		        try{            statusCode = client.executeMethod(method);            statusText  = HttpStatus.getStatusText(statusCode);            response = getBody( method );            return  statusCode == HttpStatus.SC_OK ;			        }        catch(IOException e) {            e.printStackTrace();            statusCode = 0;            statusText = e.getMessage();            return false;        }        finally {        	method.releaseConnection();        }	}		/**	 * POST METHOD 	 * 	 * @param url SAMPLE) 	 * @return true: 	 * @throws UnsupportedEncodingException	 */	public boolean post( String url ) throws UnsupportedEncodingException	{		PostMethod method = new PostMethod( url );		NameValuePair param = null;		NameValuePair[] params = new NameValuePair[ parameterList.size() ];		for( int i = 0; i < parameterList.size(); i++ )		{			param = (NameValuePair)parameterList.get(i);			param.setValue( new String(param.getValue().getBytes(), method.getRequestCharSet() ) );			params[i] = param;					}		method.setRequestBody( params );		        try{            statusCode = client.executeMethod(method);            statusText  = HttpStatus.getStatusText(statusCode);            response = getBody( method );                        return ( statusCode == HttpStatus.SC_OK );			        }        catch(IOException e) {            e.printStackTrace();            statusCode = 0;            statusText = e.getMessage();            return false;        }        finally {        	method.releaseConnection();        }	}			/**	 * SAMPLE 	 * 	 * @param args	 * @throws UnsupportedEncodingException	 */	public static void main( String[] args ) throws UnsupportedEncodingException	{		HoHttpClient http = new HoHttpClient("euc-kr");				/*		http.addParam("where", "item_xml");		http.addParam("query", "aaa");		http.addParam("start","1");		http.addParam("display","10");		http.addParam("ct","1");		http.addParam("jd","0");		http.post("http://fs.booktopia.com:9101/search.php");		*/		http.post("http://usa.ecampus-global.com/SkillSoftSDS/112553_ZH/imsmanifest.xml");						System.out.println("statusCode:" + http.getStatusCode() );		System.out.println("statusText:" + http.getStatusText());		System.out.println("=============================");		System.out.println( http.getResponse());			}}